"use strict";(self.webpackChunkdart_frog_docs=self.webpackChunkdart_frog_docs||[]).push([[684],{3905:function(e,t,o){o.d(t,{Zo:function(){return d},kt:function(){return g}});var n=o(7294);function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function l(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){a(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function i(e,t){if(null==e)return{};var o,n,a=function(e,t){if(null==e)return{};var o,n,a={},r=Object.keys(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||(a[o]=e[o]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}var u=n.createContext({}),c=function(e){var t=n.useContext(u),o=t;return e&&(o="function"==typeof e?e(t):l(l({},t),e)),o},d=function(e){var t=c(e.components);return n.createElement(u.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var o=e.components,a=e.mdxType,r=e.originalType,u=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),p=c(o),g=a,m=p["".concat(u,".").concat(g)]||p[g]||s[g]||r;return o?n.createElement(m,l(l({ref:t},d),{},{components:o})):n.createElement(m,l({ref:t},d))}));function g(e,t){var o=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=o.length,l=new Array(r);l[0]=p;var i={};for(var u in t)hasOwnProperty.call(t,u)&&(i[u]=t[u]);i.originalType=e,i.mdxType="string"==typeof e?e:a,l[1]=i;for(var c=2;c<r;c++)l[c]=o[c];return n.createElement.apply(null,l)}return n.createElement.apply(null,o)}p.displayName="MDXCreateElement"},6211:function(e,t,o){o.r(t),o.d(t,{assets:function(){return d},contentTitle:function(){return u},default:function(){return g},frontMatter:function(){return i},metadata:function(){return c},toc:function(){return s}});var n=o(7462),a=o(3366),r=(o(7294),o(3905)),l=["components"],i={sidebar_position:1},u="Google Cloud Run \u2601\ufe0f",c={unversionedId:"deploy/google-cloud-run",id:"deploy/google-cloud-run",title:"Google Cloud Run \u2601\ufe0f",description:"Cloud Run is a service in the Google Cloud Platform that allows you to deploy highly scalable containerized applications using your favorite language on a fully managed serverless platform. You can use Cloud Run to serve requests from your Dart Frog API to the internet. This will provide:",source:"@site/docs/deploy/google-cloud-run.md",sourceDirName:"deploy",slug:"/deploy/google-cloud-run",permalink:"/dart_frog/docs/deploy/google-cloud-run",draft:!1,editUrl:"https://github.com/verygoodventures/dart_frog/tree/main/docs/docs/deploy/google-cloud-run.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"docs",previous:{title:"Deploy \ud83d\ude80",permalink:"/dart_frog/docs/category/deploy-"},next:{title:"Roadmap \ud83d\uddfa\ufe0f",permalink:"/dart_frog/docs/roadmap"}},d={},s=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Deploying",id:"deploying",level:2},{value:"Additional Resources",id:"additional-resources",level:2}],p={toc:s};function g(e){var t=e.components,o=(0,a.Z)(e,l);return(0,r.kt)("wrapper",(0,n.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"google-cloud-run-\ufe0f"},"Google Cloud Run \u2601\ufe0f"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://cloud.google.com/run"},"Cloud Run")," is a service in the ",(0,r.kt)("a",{parentName:"p",href:"https://cloud.google.com/"},"Google Cloud Platform")," that allows you to deploy highly scalable containerized applications using your favorite language on a fully managed serverless platform. You can use Cloud Run to serve requests from your Dart Frog API to the internet. This will provide:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Fully managed autoscaling to handle any number of requests"),(0,r.kt)("li",{parentName:"ul"},"Only pay for the computing resources you use, and pay nothing when your service isn't being used"),(0,r.kt)("li",{parentName:"ul"},"Automatic logging in ",(0,r.kt)("a",{parentName:"li",href:"https://cloud.google.com/logging"},"Cloud Logging"))),(0,r.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,r.kt)("p",null,"Before you get started, if you don't already have these, you'll need to create:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"A ",(0,r.kt)("a",{parentName:"li",href:"https://support.google.com/accounts/answer/27441?hl=en"},"free Google Account")),(0,r.kt)("li",{parentName:"ul"},"A ",(0,r.kt)("a",{parentName:"li",href:"https://cloud.google.com/resource-manager/docs/creating-managing-projects"},"Google Cloud Platform (GCP) Project")),(0,r.kt)("li",{parentName:"ul"},"A ",(0,r.kt)("a",{parentName:"li",href:"https://cloud.google.com/billing/docs/how-to/manage-billing-account#create_a_new_billing_account"},"billing account")," connected to your GCP project")),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"While the Google Cloud Platform has a free tier that should cover testing projects, you can incur costs when running this quickstart through Cloud Run, Cloud Build, or Artifact Registry. For more details, see the ",(0,r.kt)("a",{parentName:"p",href:"https://cloud.google.com/pricing/list"},"Google Cloud Price List"),"."))),(0,r.kt)("p",null,"Additionally, you'll need the ",(0,r.kt)("a",{parentName:"p",href:"https://cloud.google.com/sdk/docs/install"},(0,r.kt)("inlineCode",{parentName:"a"},"gcloud")," command line interface (CLI)")," installed on your computer."),(0,r.kt)("p",null,"Finally, you'll want to log in to ",(0,r.kt)("inlineCode",{parentName:"p"},"gcloud")," by running:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"gcloud auth login\n")),(0,r.kt)("h2",{id:"deploying"},"Deploying"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Build your API for production use by running:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"dart_frog build\n")),(0,r.kt)("p",null,"This will create a ",(0,r.kt)("inlineCode",{parentName:"p"},"/build")," directory with all the files needed to deploy your API."),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"Deploy your API to Cloud Run by running:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"gcloud run deploy [SERVICE_NAME]\n  --source build \\           # the output of dart_frog build\n  --project=[PROJECT_ID] \\   # The Google Cloud project ID\n  --region=[REGION]  \\       # ex: us-central1\n  --allow-unauthenticated    # for public access\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"[SERVICE_NAME]"),": The name of the Cloud Run service you want to create/update"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"[PROJECT_ID]"),": The ID of the Google Cloud project"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"[REGION]"),": The GCP region you wish to deploy to")),(0,r.kt)("p",null,"Running this command will do three things:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Upload the code in the ",(0,r.kt)("inlineCode",{parentName:"li"},"/build")," directory"),(0,r.kt)("li",{parentName:"ul"},"Build the Docker image in ",(0,r.kt)("a",{parentName:"li",href:"https://cloud.google.com/build"},"Cloud Build")," and upload it to ",(0,r.kt)("a",{parentName:"li",href:"https://cloud.google.com/artifact-registry"},"Artifact Registry")),(0,r.kt)("li",{parentName:"ul"},"Deploy the image to the specified Cloud Run service")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"Congratulations! \ud83c\udf89 You have successfully built and deployed your API to Cloud Run. You can now access your API at the Service URL that is printed in the last line of output.")),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"If you have not already enabled the nessesary Google Cloud APIs to deploy your API, ",(0,r.kt)("inlineCode",{parentName:"p"},"gcloud")," can enable them for you. Just select ",(0,r.kt)("inlineCode",{parentName:"p"},"Y")," when prompted."))),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"You can save the project ID and region to ",(0,r.kt)("inlineCode",{parentName:"p"},"gcloud")," so you don't have to specify them each time you deploy."),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"gcloud config set core/project [PROJECT_ID]\ngcloud config set run/region [REGION]\n")))),(0,r.kt)("p",null,"Example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ gcloud run deploy hello  --source build --allow-unauthenticated\n\nBuilding using Dockerfile and deploying container to Cloud Run service [hello] in project [dart-demo] region [us-central1]\n\u2713 Building and deploying new service... Done.\n  \u2713 Uploading sources...\n  \u2713 Building Container... Logs are available at [https://console.cloud.google.com/cloud-build/builds/df7f07d1-d88b-4443-a2b1-bdfd3cdab15b?project=700116488077].\n  \u2713 Creating Revision... Revision deployment finished. Waiting for health check to begin.\n  \u2713 Routing traffic...\n  \u2713 Setting IAM Policy...\nDone.\nService [hello] revision [hello-00001-yen] has been deployed and is serving 100 percent of traffic.\nService URL: https://hello-gpua4upw6q-uc.a.run.app\n")),(0,r.kt)("h2",{id:"additional-resources"},"Additional Resources"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://cloud.google.com/run/docs/overview/what-is-cloud-run"},"What is Cloud Run")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://cloud.google.com/sdk/gcloud/reference/run/deploy"},(0,r.kt)("inlineCode",{parentName:"a"},"gcloud run deploy")," documentation")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://cloud.google.com/run/docs/logging"},"Cloud Run automatic logging")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://cloud.google.com/run/docs/mapping-custom-domains"},"Mapping custom domains to Cloud Run"))))}g.isMDXComponent=!0}}]);